#!/bin/sh

id=""

if [ -e "/proc/sys/kernel/random/boot_id" ]
then
	read line< /proc/sys/kernel/random/boot_id
	id=`echo ${line} | sed -e 's/-//g'`
fi

if [ -d "/var/lib/systemd/coredump" ]
then
	cd /var/lib/systemd/coredump

#remove temporary dump files
	if [ -e ".#core.*" ]
	then
		for i in `ls -a .#core.*`
		do
			rm -f "$i"
		done
	fi

	for i in `ls -a`
	do
		if [ -d $i ]
		then
			continue
		fi

#remove dump files if boot id is different
		if [ $i != *.$id.* ]
		then
			rm -f "$i"
		fi
	done
fi
